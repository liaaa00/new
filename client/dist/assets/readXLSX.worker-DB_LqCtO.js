let u=null;async function h(){const a=await import("./xlsx-B9D7-VlV.js"),n=await import("./cpexcel.full-Dj1if7_E.js");return a.set_cptable(n),a}async function y(a,n,i={}){const{onError:e=null}=i;try{u||(u=await h());const r=u.read(a,{type:"buffer",raw:!0,codepage:65001}),l=r.SheetNames.map(t=>{const p=r.Sheets[t],s=u.utils.sheet_to_json(p,{header:1,raw:!1});if(s.length<=1)return null;try{const d=s[0]?.map(o=>({name:String(o)})),m=s.slice(1).map(o=>{const c={};return o.forEach((f,g)=>{c[d[g].name]=f!==null?String(f):null}),c}).filter(o=>Object.values(o).some(c=>c!==null));return m.length?{name:t,tableData:{fields:d,records:m}}:null}catch{return e&&e({message:"message.sheetError",payload:{sheetName:t}}),null}}).filter(t=>t!==null);return l.length===0?(e&&e({message:"message.noSheet"}),null):{sheets:l,name:n}}catch(r){return e&&e({message:"message.fileError",error:r}),null}}onmessage=async function(a){const{data:n}=a,{type:i,payload:e}=n;if(i==="readXLSX"){const{data:r,name:l}=e,t=await y(r,l,{onError:({message:p,payload:s})=>postMessage({type:"error",payload:{message:p,payload:s}})});postMessage({type:"readXLSX",payload:t})}};
